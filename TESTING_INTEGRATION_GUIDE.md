# Руководство по интеграции системы тестирования

## Обзор изменений

Система тестирования была улучшена для соответствия вашим требованиям:

### 1. Структура теста (40 вопросов):
- **17 вопросов** типа `text-one` (1 правильный ответ, 2 балла)
- **4 вопроса** типа `text-two` (2 правильных ответа, 3 балла)
- **6 вопросов** типа `photo` (2 правильных ответа, 3 балла)
- **7 вопросов** типа `picture` (2 правильных ответа, 3 балла)
- **5 вопросов** типа `sign` (1 правильный ответ, 2 балла)
- **1 вопрос** типа `video` (1 правильный ответ, 5 баллов)

### 2. Система оценки:
- **Максимум**: 100 баллов
- **Проходной балл**: 60 баллов
- **Правило "все или ничего"** для вопросов с множественными ответами

## Новые файлы

### Типы данных
- `src/types/test.ts` - Полные типы для системы тестирования

### Сервисы
- `src/services/testService.ts` - Улучшенный сервис для работы с тестами

### Хуки
- `src/hooks/useTest.ts` - Хуки для управления состоянием тестов

### Компоненты
- `src/components/TestStatsCard.tsx` - Компонент для отображения статистики

## Обновленные файлы

### Экраны
- `src/screens/test/TestEntryScreen.tsx` - Добавлен выбор языка и интеграция с новым сервисом
- `src/screens/test/TestQuestionScreen.tsx` - Полная интеграция с реальными данными

### Типы навигации
- `src/types/navigation.ts` - Добавлен параметр `testId` для `TestQuestion`

## Как использовать

### 1. Запуск теста
```typescript
// В TestEntryScreen
const test = await testService.generateTest('Korean'); // или 'English'
await testService.saveTest(test);
navigation.navigate('TestQuestion', { testId: test.id });
```

### 2. Работа с вопросами
```typescript
// В TestQuestionScreen тест загружается автоматически по testId
const savedTest = await AsyncStorage.getItem(`test_${testId}`);
const test: Test = JSON.parse(savedTest);
```

### 3. Отправка результатов
```typescript
const submission: TestSubmission = {
  testId: test.id,
  language: test.language,
  answers: testAnswers,
  startedAt: startTime,
  completedAt: new Date().toISOString(),
  totalTimeSpent: timeInSeconds,
};

const result = await testService.submitTest(submission);
```

## Особенности реализации

### Поддержка медиафайлов
- Автоматическое отображение изображений для типов `photo`, `picture`, `sign`
- Поддержка видео для типа `video`
- Проверка MIME-типов для корректного отображения

### Множественные ответы
- Типы `text-two`, `photo`, `picture` поддерживают выбор нескольких ответов
- Система "все или ничего" - баллы начисляются только при выборе всех правильных ответов

### Локальное хранение
- Тесты сохраняются локально во время прохождения
- Результаты сохраняются в AsyncStorage
- Детальные результаты доступны для просмотра

## Интеграция с существующим интерфейсом

Все изменения сделаны с сохранением существующих стилей:
- Цветовая схема остается прежней
- Компоненты адаптируются к темной/светлой теме
- Анимации и переходы сохранены

## Следующие шаги

1. **Тестирование**: Проверьте работу с реальными данными из вашего API
2. **Настройка**: При необходимости измените конфигурацию в `TEST_CONFIG`
3. **Стили**: Добавьте дополнительные стили для медиафайлов если нужно
4. **Валидация**: Добавьте дополнительную валидацию данных при необходимости

## Конфигурация

Основная конфигурация находится в `testService.ts`:

```typescript
const TEST_CONFIG: TestConfiguration = {
  totalQuestions: 40,
  passingScore: 60,
  maxScore: 100,
  questionTypes: {
    'text-one': { count: 17, points: 2, multipleAnswers: false },
    'text-two': { count: 4, points: 3, multipleAnswers: true },
    // ... остальные типы
  },
};
```

Вы можете легко изменить количество вопросов, баллы или проходной балл, отредактировав эту конфигурацию.
